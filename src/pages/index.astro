---
import { getCollection } from 'astro:content'
import { SITE_TITLE, SITE_DESCRIPTION } from '../config'
import Layout from '~/layouts/PageLayout.astro'
import PostItem from '~/components/PostItem.astro'

const basename = import.meta.env.BASE_URL

const meta = {
  title: SITE_TITLE,
  description: SITE_DESCRIPTION,
}

const allPosts = await getCollection('blog')

const posts = allPosts
  .sort((a, b) => new Date(b.data.pubDate).valueOf() - new Date(a.data.pubDate).valueOf())
  .slice(0, 5)

const tags = [...new Set(allPosts.map((post) => post.data.tags).flat())]
---

<Layout {meta}>
  <div class="min-w-[80%] flex justify-center">
    <ul>
      {
        posts.map((post) => (
          <li class="mb-4">
            <PostItem post={post.data} url={`${basename}blog/${post.slug}/`} />
          </li>
        ))
      }
    </ul>
  </div>
</Layout>
